#######################################
# Install Node.js and global dependencies
# Globals:
#   None
# Arguments:
#   None
#######################################
function install_nodejs() {
  local current
  local desired

  # Check if fnm is installed
  command -v fnm >/dev/null || return 0

  current=$(fnm current)
  desired={{ .nodejs.version }}

  echo "Checking Node.js version..."
  echo "Current: $current, Desired: $desired"

  if [[ "$current" == "$desired" ]]; then
    return 0
  fi

  echo "Installing Node.js $desired..."
  fnm install "$desired"
  fnm default "$desired"

  echo "Installing global dependencies..."
  {{ .nodejs.installer }} {{ .nodejs.globals | join " " }}

}
