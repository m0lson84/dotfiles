
{{- /* Default browser */ -}}
{{- $browser := "chrome" -}}
{{- if .env.wsl -}}
{{- $browser = "/mnt/c/Program Files/Google/Chrome/Application/chrome.exe" -}}
{{- end -}}

{{- /* Default terminal */ -}}
{{- $terminal := "wezterm" -}}
{{- if eq .env.os "windows" -}} {{- $terminal = "wt" -}} {{- end -}}


#             _
#            | |
#     _______| |__  _ __ ___
#    |_  / __| '_ \| '__/ __|
#   _ / /\__ \ | | | | | (__
#  (_)___|___/_| |_|_|  \___|
#
#


# XDG Base Directory Specification
export XDG_CACHE_HOME=${XDG_CACHE_HOME:="$HOME/.cache"}
export XDG_CONFIG_HOME=${XDG_CONFIG_HOME:="$HOME/.config"}
export XDG_DATA_HOME=${XDG_DATA_HOME:="$HOME/.local/share"}

{{ if not .env.ephemeral -}}
# Enable Homebrew auto completion
HOMEBREW_PREFIX={{ if eq .env.os "linux" -}} /home/linuxbrew/.linuxbrew {{- else -}} /usr/local {{- end }}
FPATH="${HOMEBREW_PREFIX}/share/zsh/site-functions:${FPATH}"
unset HOMEBREW_PREFIX
{{- end }}

# If you come from bash you might have to change your $PATH.
export PATH=$HOME/bin:/usr/local/bin:$PATH

# ZSH configuration
ZSH=$HOME/.oh-my-zsh

# VS Code plugin
VSCODE="code"

# Disable Oh-My-ZSH update
DISABLE_UPDATE_PROMPT=true
DISABLE_AUTO_UPDATE=true

# Oh-My-ZSH Plugins
source "$XDG_CONFIG_HOME"/zsh/plugins.zsh

# Initialize Oh-My-ZSH
source $ZSH/oh-my-zsh.sh

# ZShell options
setopt autocd
setopt histignorespace

{{ if eq .env.os "darwin" -}}

# Additional paths
export PATH="/usr/local/opt/openssl@1.1/bin:$PATH"
export PATH="/usr/local/opt/python@3.10/bin:$PATH"
export PATH="/usr/local/sbin:$PATH"

{{ end -}}

# Default Apps
export BROWSER={{ $browser | quote }}
export EDITOR="nvim"
export TERMINAL={{ $terminal | quote }}
export VISUAL="nvim"

# Load additional configurations
source "$XDG_CONFIG_HOME"/zsh/.fzf.zsh
source "$XDG_CONFIG_HOME"/zsh/aliases.zsh
source "$XDG_CONFIG_HOME"/zsh/completions.zsh
source "$XDG_CONFIG_HOME"/zsh/functions.zsh

{{ if not .env.ephemeral -}}

# 1Password CLI configuration
export SSH_AUTH_SOCK=~/.1password/agent.sock
eval "$(op completion zsh)"; compdef _op op

# Golang configuration
export GOPATH="$HOME/go"
export PATH="${GOPATH}/bin:$PATH"

# iTerm2 integration
test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"

# Kubectl auto completion
command -v kubectl >/dev/null && source <(kubectl completion zsh)

# Node.js configuration
command -v nodenv >/dev/null && eval "$(nodenv init -)"

# Python configuration
export PATH="${HOME}/.local/bin:$PATH"
export PYENV_ROOT="$HOME/.pyenv"
export CONFIGURE_OPTS="-with-openssl=$(brew --prefix openssl)"
command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
command -v pyenv >/dev/null && eval "$(pyenv init -)"

# Rust configuration
source "${HOME}/.cargo/env"

{{ end -}}

# Starship initialization
export STARSHIP_CONFIG="$XDG_CONFIG_HOME"/starship/starship.toml
eval "$(starship init zsh)"
eval "$(starship completions zsh)"
